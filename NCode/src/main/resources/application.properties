spring.application.name=NCode

# Configuración del contexto de la aplicación
server.servlet.context-path=${SERVER_CONTEXT_PATH:/NCod3}

# Configuración del puerto (Render usa la variable PORT)
server.port=${PORT:8080}

# Configuración de Base de Datos PostgreSQL (usar variables de entorno para producción)
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://localhost:5432/ncodegestion}
spring.datasource.username=${DATABASE_USERNAME:ncode_user}
spring.datasource.password=${DATABASE_PASSWORD:N0l0s4br4s.}
spring.datasource.driver-class-name=org.postgresql.Driver

# Configuración de JPA/Hibernate para PostgreSQL
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.physical_naming_strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
spring.jpa.properties.hibernate.globally_quoted_identifiers=false
spring.jpa.properties.hibernate.auto_quote_keyword=false

# Configuración de Email
# Configuración anterior (comentada)
# Para desarrollo local: usa los valores por defecto
# Para Render: usa las variables de entorno MAIL_HOST, MAIL_PORT, MAIL_USERNAME, MAIL_PASSWORD
#spring.mail.host=${MAIL_HOST:mail.indigo-negocios.com}
#spring.mail.port=${MAIL_PORT:465}
#spring.mail.username=${MAIL_USERNAME:ncodeactive@indigo-negocios.com}
# Para local: usar password directamente. Para Render: usar variable de entorno MAIL_PASSWORD
#spring.mail.password=${MAIL_PASSWORD:InurXd}mof]CDtw8fo}
#spring.mail.properties.mail.smtp.auth=true
#spring.mail.properties.mail.smtp.ssl.enable=true
#spring.mail.properties.mail.smtp.ssl.trust=${MAIL_HOST:mail.indigo-negocios.com}
#spring.mail.properties.mail.smtp.ssl.checkserveridentity=false
#spring.mail.properties.mail.smtp.connectiontimeout=5000
#spring.mail.properties.mail.smtp.timeout=5000
#spring.mail.properties.mail.smtp.writetimeout=5000
#spring.mail.properties.mail.smtp.starttls.enable=false
#spring.mail.properties.mail.smtp.starttls.required=false
#spring.mail.properties.mail.debug=false

# Configuración de Email - Zoho
# Para desarrollo local: usa los valores por defecto (puerto 587 con STARTTLS)
# Para Render: usa las variables de entorno para puerto 465 con SSL (más confiable en hosting)
# IMPORTANTE: Zoho requiere usar "App Password" (Contraseña de Aplicación) en lugar de la contraseña normal
# Genera una App Password desde: https://accounts.zoho.com/home#security/app-passwords
spring.mail.host=${MAIL_HOST:smtp.zoho.com}
# Puerto: 587 para STARTTLS (local) o 465 para SSL (Render - recomendado para evitar timeouts)
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:albertinovillar@ncod3.com}
# Para local: usar password directamente. Para Render: usar variable de entorno MAIL_PASSWORD
# NOTA: Debes usar una "App Password" generada desde Zoho, NO la contraseña normal de la cuenta
spring.mail.password=${MAIL_PASSWORD:Miux07MmNZUn}
spring.mail.properties.mail.smtp.auth=true
# SSL: habilitado para puerto 465, deshabilitado para puerto 587
spring.mail.properties.mail.smtp.ssl.enable=${MAIL_SSL_ENABLE:false}
spring.mail.properties.mail.smtp.ssl.trust=${MAIL_HOST:smtp.zoho.com}
spring.mail.properties.mail.smtp.ssl.checkserveridentity=true
spring.mail.properties.mail.smtp.connectiontimeout=30000
spring.mail.properties.mail.smtp.timeout=30000
spring.mail.properties.mail.smtp.writetimeout=30000
# STARTTLS: habilitado para puerto 587, deshabilitado para puerto 465
spring.mail.properties.mail.smtp.starttls.enable=${MAIL_STARTTLS_ENABLE:true}
spring.mail.properties.mail.smtp.starttls.required=${MAIL_STARTTLS_REQUIRED:true}
# SocketFactory para SSL (solo necesario para puerto 465)
spring.mail.properties.mail.smtp.socketFactory.port=${MAIL_SOCKET_PORT:}
spring.mail.properties.mail.smtp.socketFactory.class=${MAIL_SOCKET_CLASS:}
spring.mail.properties.mail.smtp.socketFactory.fallback=false
# Habilitar debug temporalmente para diagnosticar problemas (cambiar a true si necesitas ver detalles)
spring.mail.properties.mail.debug=false

# Configuración de Logging
logging.level.org.hibernate=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN
logging.level.org.springframework=WARN
logging.level.com.admin.ncode=INFO
logging.level.com.admin.ncode.service.EmailService=DEBUG
logging.level.org.springframework.mail=DEBUG

# Configuración de Seguridad de Sesiones
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=${SESSION_SECURE:false}
server.servlet.session.cookie.same-site=strict
server.servlet.session.timeout=30m
server.servlet.session.tracking-modes=cookie

# Headers de Seguridad (se configuran también en SecurityConfig)
server.error.include-message=never
server.error.include-binding-errors=never
server.error.include-stacktrace=never
server.error.include-exception=false
